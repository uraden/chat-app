(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{278:function(e,t,n){},279:function(e,t,n){},303:function(e,t,n){},422:function(e,t){},459:function(e,t){},467:function(e,t,n){},468:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(19),o=n.n(i),c=(n(278),n(125)),s=n(23),l=n(160),d=n(79),u=n(80),h=n(82),j=n(81),m=n(498),p=n(502),g=n(503),x=n(504),b=n(505),f=n(514),O=n(507),v=(n(279),n(6)),y=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).login=function(){var e=a.state,t=e.email,n=e.room;t&&n&&a.props.history.push("chat",{room:n,email:t})},a.handleChange=function(e){a.setState(Object(l.a)({},e.target.name,e.target.value))},a.state={email:"",room:""},a}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.room;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(m.a,{style:k.header,elevation:10,children:Object(v.jsx)(p.a,{children:Object(v.jsx)(g.a,{variant:"h6",children:"Chat App with Twilio Programmable Chat and React"})})}),Object(v.jsxs)("div",{className:"intro",children:[Object(v.jsx)("h1",{className:"intro1",style:{fontSize:"20px",textAlign:"center",color:"#3F51B5"},children:"  Please enter your email address and your "}),Object(v.jsx)("h1",{style:Object(l.a)({fontSize:"20px",textAlign:"center",color:"#3F51B5",paddingLeft:"5px",paddingRight:"5px"},"color","red"),children:" unique* "}),Object(v.jsx)("h1",{style:{fontSize:"20px",textAlign:"center",color:"#3F51B5"},children:"  Room number to join the chat"})]}),Object(v.jsx)(x.a,{style:k.grid,container:!0,direction:"column",justify:"center",alignItems:"center",children:Object(v.jsxs)(b.a,{style:k.card,elevation:10,children:[Object(v.jsx)(x.a,{item:!0,style:k.gridItem,children:Object(v.jsx)(f.a,{name:"email",required:!0,style:k.textField,label:"Email address",placeholder:"Enter email address",variant:"outlined",type:"email",value:t,onChange:this.handleChange})}),Object(v.jsx)(x.a,{item:!0,style:k.gridItem,children:Object(v.jsx)(f.a,{name:"room",required:!0,style:k.textField,label:"Room",placeholder:"Enter room name",variant:"outlined",value:n,onChange:this.handleChange})}),Object(v.jsx)(x.a,{item:!0,style:k.gridItem,children:Object(v.jsx)(O.a,{color:"primary",variant:"contained",style:k.button,onClick:this.login,children:"Login"})})]})})]})}}]),n}(r.a.Component),k={header:{},grid:{position:"absolute",top:0,left:0,right:0,bottom:0},card:{padding:40},textField:{width:300},gridItem:{paddingTop:12,paddingBottom:12},button:{width:300}},w=y,C=n(268),S=n(9),T=n.n(S),I=n(67),F=n(509),B=n(515),A=n(510),E=n(511),M=n(506),D=n(512),L=n(513),R=n(267),z=n.n(R),q=n(508),N=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.email,a=t.author===n;return Object(v.jsxs)(q.a,{style:P.listItem(a),children:[Object(v.jsx)("div",{style:P.author,children:t.author}),Object(v.jsxs)("div",{style:P.container(a),children:[t.body,Object(v.jsx)("div",{style:P.timestamp,children:new Date(t.dateCreated.toISOString()).toLocaleString()})]})]})}}]),n}(r.a.Component),P={listItem:function(e){return{flexDirection:"column",borderRadius:15,marginTop:10,alignItems:e?"flex-end":"flex-start"}},container:function(e){return{maxWidth:"75%",borderRadius:e?"35% 35% 0 35%":"0 35% 35% 35%",padding:16,color:"white",fontSize:20,background:e?"linear-gradient(#EB896D, #F75479)":"linear-gradient(#39cc8f, #39ccb4)"}},author:{fontSize:10,color:"blue",fontWeight:900},timestamp:{fontSize:10,color:"pink",textAlign:"right",paddingTop:4,fontWeight:900}},W=N,U=(n(303),n(304)),J=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).joinChannel=function(){var e=Object(I.a)(T.a.mark((function e(t){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"===t.channelState.status){e.next=3;break}return e.next=3,t.join();case 3:a.setState({channel:t,loading:!1}),t.on("messageAdded",a.handleMessageAdded),a.scrollToBottom();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleMessageAdded=function(e){var t=a.state.messages;a.setState({messages:[].concat(Object(C.a)(t),[e])},a.scrollToBottom)},a.scrollToBottom=function(){var e=a.scrollDiv.current.scrollHeight-a.scrollDiv.current.clientHeight;a.scrollDiv.current.scrollTop=e>0?e:0},a.componentDidMount=Object(I.a)(T.a.mark((function e(){var t,n,r,i,o,c,s,l,d;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.location,n=(t||{}).state,i=(r=n||{}).email,o=r.room,c="",i&&o||a.props.history.replace("/"),a.setState({loading:!0}),e.prev=6,e.next=9,a.getToken(i);case 9:c=e.sent,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(6),new Error("Unable to get token, please reload this page");case 15:return e.next=17,U.Client.create(c);case 17:return(s=e.sent).on("tokenAboutToExpire",Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getToken(i);case 2:t=e.sent,s.updateToken(t);case 4:case"end":return e.stop()}}),e)})))),s.on("tokenExpired",Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getToken(i);case 2:t=e.sent,s.updateToken(t);case 4:case"end":return e.stop()}}),e)})))),s.on("channelJoined",function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMessages();case 2:n=e.sent,a.setState({messages:n.items||[]}),a.scrollToBottom();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.prev=21,e.next=24,s.getChannelByUniqueName(o);case 24:l=e.sent,a.joinChannel(l),e.next=40;break;case 28:return e.prev=28,e.t1=e.catch(21),e.prev=30,e.next=33,s.createChannel({uniqueName:o,friendlyName:o});case 33:d=e.sent,a.joinChannel(d),e.next=40;break;case 37:throw e.prev=37,e.t2=e.catch(30),new Error("Unable to create channel, please reload this page");case 40:case"end":return e.stop()}}),e,null,[[6,12],[21,28],[30,37]])}))),a.getToken=function(){var e=Object(I.a)(T.a.mark((function e(t){var n,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.a.get("http://localhost:5000/token/".concat(t));case 2:return n=e.sent,a=n.data,e.abrupt("return",a.token);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.sendMessage=function(){var e=a.state,t=e.text,n=e.channel;t&&(a.setState({loading:!0}),n.sendMessage(String(t).trim()),a.setState({text:"",loading:!1}))},a.state={text:"",messages:[],loading:!1,channel:null},a.scrollDiv=r.a.createRef(),a}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.text,r=t.messages,i=t.channel,o=(this.props.location||{}).state||{},c=o.email,s=o.room;return Object(v.jsxs)(F.a,{component:"main",maxWidth:"md",children:[Object(v.jsx)("h1",{style:{fontSize:"50px",marginTop:"90px",marginBottom:"-60px",textAlign:"center"},children:" Live Chat App with  Twilio API "}),Object(v.jsx)(B.a,{open:n,style:{zIndex:99999},children:Object(v.jsx)(A.a,{style:{color:"white"}})}),Object(v.jsx)(m.a,{elevation:10,children:Object(v.jsx)(p.a,{children:Object(v.jsx)(g.a,{variant:"h6",children:"Room: ".concat(s,", User: ").concat(c)})})}),Object(v.jsx)(E.a,{}),Object(v.jsxs)(x.a,{container:!0,direction:"column",style:G.mainGrid,children:[Object(v.jsx)(x.a,{item:!0,style:G.gridItemChatList,ref:this.scrollDiv,children:Object(v.jsx)(M.a,{dense:!0,children:r&&r.map((function(e){return Object(v.jsx)(W,{message:e,email:c},e.index)}))})}),Object(v.jsx)(x.a,{item:!0,style:G.gridItemMessage,children:Object(v.jsxs)(x.a,{container:!0,direction:"row",justify:"center",alignItems:"center",children:[Object(v.jsx)(x.a,{item:!0,style:G.textFieldContainer,children:Object(v.jsx)(f.a,{className:"textfield",required:!0,style:G.textField,placeholder:"Enter message",variant:"outlined",multiline:!0,rows:2,value:a,onKeyPress:function(t){"Enter"===t.key&&e.sendMessage()},disabled:!i,onChange:function(t){return e.setState({text:t.target.value})}})}),Object(v.jsx)(x.a,{item:!0,children:Object(v.jsx)(D.a,{style:G.sendButton,onClick:this.sendMessage,disabled:!i,children:Object(v.jsx)(L.a,{style:G.sendIcon})})})]})})]})]})}}]),n}(r.a.Component),G={gridItem:{paddingTop:12,paddingBottom:92},gridItemChatList:{overflow:"auto",height:"60vh",backgroundColor:"#EFF7F9",borderRadius:25,boxShadow:"15px"},gridItemMessage:{marginTop:12,marginBottom:12},sendButton:{backgroundColor:"#0076F6",marginLeft:"10px"},sendIcon:{color:"white"},mainGrid:{paddingTop:80,borderWidth:0}},H=J;n(467);var K=function(){return Object(v.jsx)(c.a,{children:Object(v.jsxs)(s.c,{children:[Object(v.jsx)(s.a,{path:"/",exact:!0,component:w}),Object(v.jsx)(s.a,{path:"/chat",component:H})]})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,517)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};o.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(K,{})}),document.getElementById("root")),Q()}},[[468,1,2]]]);
//# sourceMappingURL=main.78b27c45.chunk.js.map